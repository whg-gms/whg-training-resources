"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[4974],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,m=c["".concat(s,".").concat(d)]||c[d]||h[d]||o;return n?a.createElement(m,l(l({ref:t},u),{},{components:n})):a.createElement(m,l({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8424:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:7},l="Challenge questions",i={unversionedId:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions",id:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions",title:"Challenge questions",description:"We have three challenges.:",source:"@site/docs/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions.md",sourceDirName:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis",slug:"/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Challenge_questions.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"sidebar9",previous:{title:"Step 4: Viewing alignments",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Viewing_alignments"},next:{title:"Bonus tutorial: how accurate is Illumina sequencing?",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/De_novo_error_rate_estimation"}},s={},p=[{value:"Challenge 1: analyse some human data",id:"challenge-1-analyse-some-human-data",level:2},{value:"Challenge 2: explore reads using <code>IGV</code>",id:"challenge-2-explore-reads-using-igv",level:2},{value:"Challenge 3: figure out the GC bump.",id:"challenge-3-figure-out-the-gc-bump",level:3},{value:"Using NCBI BLAST",id:"using-ncbi-blast",level:4}],u={toc:p},c="wrapper";function h(e){let{components:t,...o}=e;return(0,r.kt)(c,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"challenge-questions"},"Challenge questions"),(0,r.kt)("p",null,"We have three challenges.:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If you want more practice running the pipelines outlined in the practical, try Challenge 1.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If you have ",(0,r.kt)("inlineCode",{parentName:"p"},"IGV")," installed on your laptop, and want experience visualising reads in the desktop application (IGV),\ntry Challenge 2.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If you want a real challenge understanding the ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Quality_control#per-sequence-gc-content"},"GC bump"),", try Challenge 3."))),(0,r.kt)("h2",{id:"challenge-1-analyse-some-human-data"},"Challenge 1: analyse some human data"),(0,r.kt)("p",null,"In the folder ",(0,r.kt)("inlineCode",{parentName:"p"},"human/")," you'll find some data from a human sample - NA12878:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ls ~sequence_data_analysis/human/\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Challenge.")," QC and align this data using the methods described in the practical. Then look at the result\nusing ",(0,r.kt)("inlineCode",{parentName:"p"},"samtools tview"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," This data is subsampled to chromosome 19. It is a bit bigger than the malaria data; to\nspeed this up you can probably get away with using up to 4 threads in the ",(0,r.kt)("inlineCode",{parentName:"p"},"bwa mem")," step - but no\nmore than 4 please!"),(0,r.kt)("p",null,"A good region to view is around the gene ",(0,r.kt)("em",{parentName:"p"},"FUT2"),", which is at ",(0,r.kt)("inlineCode",{parentName:"p"},"chr19:48645971-48755951"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Question.")," The SNP ",(0,r.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/snp/rs601338"},"rs601338")," in the ",(0,r.kt)("em",{parentName:"p"},"FUT2"),"\ndetermines ",(0,r.kt)("em",{parentName:"p"},"secretor status"),". Being a ",(0,r.kt)("em",{parentName:"p"},"non-secretor")," means that blood group antigens (encoded by\nABO and other loci) are not secreted or expressed into bodily fluids in the normal way.\nNon-secretors are ",(0,r.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6171556/"},"protected against some pathogens including\n",(0,r.kt)("em",{parentName:"a"},"norovirus")),", but are also more susceptible\nto others - so it can be medically important what status you have."),(0,r.kt)("p",null,"Secretor status is a recessive trait, so the table of genotypes and secretor status at rs601338 is:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"genotype"),(0,r.kt)("th",{parentName:"tr",align:null},"secretor status"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"GG"),(0,r.kt)("td",{parentName:"tr",align:null},"secretor")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"GA"),(0,r.kt)("td",{parentName:"tr",align:null},"secretor")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"AA"),(0,r.kt)("td",{parentName:"tr",align:null},"non-secretor")))),(0,r.kt)("p",null,"What genotype does NA12878 have at rs601338?  Are they a secretor or non-secretor?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," the SNP is at ",(0,r.kt)("inlineCode",{parentName:"p"},"chr19:48703417")," as you can see ",(0,r.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/snp/rs601338"},"on dbSNP"),"."),(0,r.kt)("p",null,"Look for other variation.  Can you see an indel?"),(0,r.kt)("h2",{id:"challenge-2-explore-reads-using-igv"},"Challenge 2: explore reads using ",(0,r.kt)("inlineCode",{parentName:"h2"},"IGV")),(0,r.kt)("p",null,"This challenge is an alternative to Challenge 1 and will ",(0,r.kt)("strong",{parentName:"p"},"only work if you have IGV installed on your laptop"),".\nTo get set up:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Start IGV on your laptop (not JupyterHub) and make sure you have selected human build 38 from the 'genomes' drop down."),(0,r.kt)("li",{parentName:"ul"},"Load the track for NA12878 data from the following urls:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  BAM URL: https://www.well.ox.ac.uk/~gav/projects/oxford_statgen_summer_school/sequence_data_analysis/solutions/human/\nINDEX URL: https://www.well.ox.ac.uk/~gav/projects/oxford_statgen_summer_school/sequence_data_analysis/solutions/human/\n")),(0,r.kt)("p",null,"Now browse the genome in IGV."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Challenge.")," Can you find:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"a heterozygous SNP?"),(0,r.kt)("li",{parentName:"ol"},"a homozygous SNP?"),(0,r.kt)("li",{parentName:"ol"},"an insertion or deletion?"),(0,r.kt)("li",{parentName:"ol"},"a larger structural variant?"),(0,r.kt)("li",{parentName:"ol"},"a region where the coverage is unusually high (or low)?"),(0,r.kt)("li",{parentName:"ol"},"With reference to ",(0,r.kt)("strong",{parentName:"li"},"challenge 1"),", what is the secretor status of this sample?"),(0,r.kt)("li",{parentName:"ol"},"Can you find a read with clipped bases?  (Hint: to show clipped bases, you need to go to ",(0,r.kt)("inlineCode",{parentName:"li"},"View->Preferences->Alignments")," and turn 'show soft-clipped bases' on.)")),(0,r.kt)("h3",{id:"challenge-3-figure-out-the-gc-bump"},"Challenge 3: figure out the GC bump."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," This is a real challenge.  I don't fully know the answer right now."),(0,r.kt)("p",null,"In the ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Quality_control"},"QC section")," we saw this weird pattern of GC content for the malaria sample ",(0,r.kt)("inlineCode",{parentName:"p"},"QG0033-C"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(2152).Z,width:"902",height:"656"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Challenge")," figure out what the extra bump is."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Hints.")," "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Maybe this is some kind of contamination? Since we have aligned the reads to the ",(0,r.kt)("em",{parentName:"p"},"P.falciparum"),"\ngenome, we might be able to find the contamination by searching for ",(0,r.kt)("em",{parentName:"p"},"unmapped reads"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"unmapped reads are identified by one of the ",(0,r.kt)("a",{parentName:"p",href:"https://broadinstitute.github.io/picard/explain-flags.html"},"SAM\nflags"),".  To pull them out you could do something like this:"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"samtools view -f 4 -o QG0033-C-unaligned.bam QG0033-C.bam\nsamtools view -F 4 -o QG0033-C-onlyaligned.bam QG0033-C.bam\n")),(0,r.kt)("p",null,"(The ",(0,r.kt)("inlineCode",{parentName:"p"},"-f")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"-F")," option means: exclude or include reads with these flags)."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Now you could run both these bam files through fastqc to estimate the GC content seperately.  Does this explain the bump?")),(0,r.kt)("h4",{id:"using-ncbi-blast"},"Using NCBI BLAST"),(0,r.kt)("p",null,"One way to go further now is to take some reads from the unaligned BAM file and try BLASTing them\nto lots of other sequences. You can do that as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Visit ",(0,r.kt)("a",{parentName:"li",href:"https://blast.ncbi.nlm.nih.gov/Blast.cgi"},"NCBI blast")," and choose 'Nucleotide BLAST'"),(0,r.kt)("li",{parentName:"ul"},"Pick a read from the unaligned BAM and paste its sequence into the 'FASTA sequence' box"),(0,r.kt)("li",{parentName:"ul"},"To get this to work, for most reads I found I had to choose the ",(0,r.kt)("inlineCode",{parentName:"li"},"'Somewhat similar sequences (blastn)")," option.")),(0,r.kt)("p",null,"Do the reads align?  To what organism?  What's going on?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note"),". For example this was one result I got:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(4777).Z,width:"1824",height:"682"})),(0,r.kt)("p",null,"You can try looking at where these reads align to (here ",(0,r.kt)("inlineCode",{parentName:"p"},"Pf3D7_08_v3:1525593-1525692"),") e.g. in ",(0,r.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/jbrowse?data=/a/service/jbrowse/tracks/default&tracks=gene"},"PlasmoDB\nbrowser")," or the ",(0,r.kt)("a",{parentName:"p",href:"https://www.malariagen.net/apps/pf3k/release_3/index.html#genomebrowser"},"Pf3k\nbrowser"),". What could be going on?"))}h.isMDXComponent=!0},4777:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/BLAST_result-075c479ff7d62c3d9b9bdd63976907ad.png"},2152:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/fastqc_gc_content-484e6b7afd5a3c86f25b9ebbcc832ed3.png"}}]);