"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[6656],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=i,g=u["".concat(s,".").concat(m)]||u[m]||c[m]||r;return n?a.createElement(g,o(o({ref:t},d),{},{components:n})):a.createElement(g,o({ref:t},d))}));function g(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},128:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:1},o="Introduction",l={unversionedId:"sequence_data_analysis/building_an_ngs_pipeline/Introduction",id:"sequence_data_analysis/building_an_ngs_pipeline/Introduction",title:"Introduction",description:"In this tutorial you will bring a set of FASTQ files",source:"@site/docs/sequence_data_analysis/building_an_ngs_pipeline/Introduction.md",sourceDirName:"sequence_data_analysis/building_an_ngs_pipeline",slug:"/sequence_data_analysis/building_an_ngs_pipeline/Introduction",permalink:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/Introduction",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/sequence_data_analysis/building_an_ngs_pipeline/Introduction.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"sidebar9",previous:{title:"A sequence data pipelining challenge!",permalink:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/"},next:{title:"The pipeline",permalink:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/pipeline"}},s={},p=[{value:"Obtaining the needed software.",id:"obtaining-the-needed-software",level:3},{value:"Obtaining the data",id:"obtaining-the-data",level:3},{value:"Getting started",id:"getting-started",level:2},{value:"Table of contents",id:"table-of-contents",level:2}],d={toc:p},u="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"In this tutorial you will bring a set of ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/FASTQ_format"},"FASTQ files"),"\nrepresenting reads from an Illumina sequencing platform through a basic NGS data processing\npipeline. You will have to QC and align the reads, identify or remove duplicate reads, compute\ncoverage and generate an initial set of variant calls."),(0,i.kt)("p",null,"Before starting you will need to set up a few things - some data and some software. This page\ndetails what you need."),(0,i.kt)("h3",{id:"obtaining-the-needed-software"},"Obtaining the needed software."),(0,i.kt)("p",null,"You will need quite a bit of software to implement this pipeline - including:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/lh3/bwa"},(0,i.kt)("inlineCode",{parentName:"a"},"bwa"))," software for aligning reads."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/samtools/samtools"},(0,i.kt)("inlineCode",{parentName:"a"},"samtools"))," for general data manipulation."),(0,i.kt)("li",{parentName:"ul"},"The pipelining tool ",(0,i.kt)("a",{parentName:"li",href:"https://snakemake.readthedocs.io/en/stable/"},(0,i.kt)("inlineCode",{parentName:"a"},"snakemake")),". (Or, if you\nprefer, you can use another workflow management tool of your choice. ",(0,i.kt)("a",{parentName:"li",href:"https://openwdl.org"},(0,i.kt)("inlineCode",{parentName:"a"},"WDL")),"\nand ",(0,i.kt)("a",{parentName:"li",href:"https://www.nextflow.io"},(0,i.kt)("inlineCode",{parentName:"a"},"Nextflow"))," are two possibilities. This tutorial focusses on\nsnakemake though, so if you go this route, you'll have to work out all the details yourself.)"),(0,i.kt)("li",{parentName:"ul"},"For QC: ",(0,i.kt)("a",{parentName:"li",href:"https://www.bioinformatics.babraham.ac.uk/projects/fastqc/"},(0,i.kt)("inlineCode",{parentName:"a"},"fastqc"))," and ",(0,i.kt)("a",{parentName:"li",href:"https://multiqc.info"},(0,i.kt)("inlineCode",{parentName:"a"},"multiqc"))),(0,i.kt)("li",{parentName:"ul"},"For coverage calculations: ",(0,i.kt)("a",{parentName:"li",href:"https://bedtools.readthedocs.io/en/latest/index.html"},(0,i.kt)("inlineCode",{parentName:"a"},"bedtools"))),(0,i.kt)("li",{parentName:"ul"},"For variant calling: ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/luntergroup/octopus"},(0,i.kt)("inlineCode",{parentName:"a"},"octopus")),".")),(0,i.kt)("p",null,"The simplest way to get this software is to ",(0,i.kt)("a",{parentName:"p",href:"/whg-training-resources/prerequisites/CONDA"},"install conda")," - including\nadding the bioconda and conda-forge channels. At that point installing the software should be\nas easy as running:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"mamba install bwa samtools snakemake fastqc bedtools octopus\n")),(0,i.kt)("p",null,"If this doesn't work or you are using another system, alternatives are to use your system's package\nmanager and/or to install software from source.  Please try to install before starting."),(0,i.kt)("h3",{id:"obtaining-the-data"},"Obtaining the data"),(0,i.kt)("p",null,"In this tutorial we will work with a set of fastq files representing ",(0,i.kt)("em",{parentName:"p"},"P.falciparum")," (malaria) sequence\nreads from 5 samples. The data comes from the\n",(0,i.kt)("a",{parentName:"p",href:"https://www.malariagen.net/resource/26"},"MalariaGEN Pf6 open resource"),"\n(described further in the ",(0,i.kt)("a",{parentName:"p",href:"https://wellcomeopenresearch.org/articles/6-42"},"corresponding publication"),")\nand is publicly available via the ",(0,i.kt)("a",{parentName:"p",href:"https://www.ebi.ac.uk/ena/browser/home"},"European Nucleotide Archive"),"."),(0,i.kt)("p",null,"To get started, create a new directory and cd into it:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"mkdir ngs_tutorial\ncd ngs_tutorial\n")),(0,i.kt)("p",null,"To get the data, download the ",(0,i.kt)("inlineCode",{parentName:"p"},"ngs_pipeline_data.tgz")," data tarball from\n",(0,i.kt)("a",{parentName:"p",href:"https://www.well.ox.ac.uk/~gav/projects/whg-training-resources/data/sequence_data_analysis/building_an_ngs_pipeline/"},"this link"),".  For example you can do this using curl:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"curl -O https://www.well.ox.ac.uk/~gav/projects/whg-training-resources/data/sequence_data_analysis/building_an_ngs_pipeline/ngs_pipeline_data.tgz\n")),(0,i.kt)("p",null,"This will take a minute or two to download. Once it has finished, extract the tarball into your ",(0,i.kt)("inlineCode",{parentName:"p"},"ngs_tutorial")," directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"tar -xzf /path/to/ngs_pipeline_data.tgz\n")),(0,i.kt)("p",null,"(Once this is successful you can delete the downloaded tarball if you wish)."),(0,i.kt)("p",null,"Have a look at what has been downloaded.  You should see:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A ",(0,i.kt)("strong",{parentName:"p"},"samples file"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"samples.tsv"),". This lists the identifiers, accessions, and original filenames\nfor five samples that we will process.  Have a look at it now using ",(0,i.kt)("inlineCode",{parentName:"p"},"less")," or in a text editor.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Some sequence data reads in the ",(0,i.kt)("inlineCode",{parentName:"p"},"data/reads")," folder.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"A reference genome assembly, named ",(0,i.kt)("inlineCode",{parentName:"p"},"Pf3D7_v3"),", in ",(0,i.kt)("inlineCode",{parentName:"p"},"data/reference"),"."))),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If you want to, instead of using the supplied read files you can go and get the original versions\nof the fastq files from the links supplied in the ",(0,i.kt)("inlineCode",{parentName:"p"},"samples.tsv")," file. The data as deposited on ENA\nis about 12Gb - for this tutorial I have downsampled to around 2Gb to make things a bit quicker and\nuse less space."))),(0,i.kt)("h2",{id:"getting-started"},"Getting started"),(0,i.kt)("p",null,"You're all set!  Now go the the ",(0,i.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/pipeline"},"pipeline page"),"."),(0,i.kt)("h2",{id:"table-of-contents"},"Table of contents"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"./introduction.md"},"This introduction")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/pipeline"},"Building the pipeline")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/tips_and_tricks"},"Pipeine tips and tricks"))))}c.isMDXComponent=!0}}]);