"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[8482],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=o,h=c["".concat(s,".").concat(u)]||c[u]||m[u]||i;return n?a.createElement(h,r(r({ref:t},d),{},{components:n})):a.createElement(h,r({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,r[1]=l;for(var p=2;p<i;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3867:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const i={sidebar_position:2},r="Setting up Conda",l={unversionedId:"prerequisites/CONDA",id:"prerequisites/CONDA",title:"Setting up Conda",description:"One of the easiest ways to set up your environment that works across platforms is to use conda.",source:"@site/docs/prerequisites/CONDA.md",sourceDirName:"prerequisites",slug:"/prerequisites/CONDA",permalink:"/whg-training-resources/prerequisites/CONDA",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/prerequisites/CONDA.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"sidebar1",previous:{title:"Setting up a UNIX terminal",permalink:"/whg-training-resources/prerequisites/UNIX"},next:{title:"R and RStudio",permalink:"/whg-training-resources/prerequisites/R"}},s={},p=[{value:"Installing conda",id:"installing-conda",level:2},{value:"Activating and deactivating conda",id:"activating-and-deactivating-conda",level:2},{value:"Using conda to install software",id:"using-conda-to-install-software",level:2},{value:"Getting mamba",id:"getting-mamba",level:3},{value:"Installing samtools",id:"installing-samtools",level:3},{value:"Aside: what even is an &#39;environment&#39;?",id:"aside-what-even-is-an-environment",level:2}],d={toc:p},c="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"setting-up-conda"},"Setting up Conda"),(0,o.kt)("p",null,"One of the easiest ways to set up your environment that works across platforms is to use conda.\nConda creates 'virtual environments' that don't break the rest of your system, and uses a\ncomprehensive package manager. It has a dedicated ",(0,o.kt)("a",{parentName:"p",href:"https://bioconda.github.io"},"bioconda channel"),"\nthat makes it easy to install software for biomedical research."),(0,o.kt)("h2",{id:"installing-conda"},"Installing conda"),(0,o.kt)("p",null,"The recommended way is to install ",(0,o.kt)("inlineCode",{parentName:"p"},"miniconda")," which is a minimal environment that lets you install\nthe packages you want.  To get it: "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"If you are on Mac OS X or linux"),", download the appropriate installer from ",(0,o.kt)("a",{parentName:"p",href:"https://docs.conda.io/en/latest/miniconda.html"},"the miniconda download\npage"),".  (For Mac OS X, we recommend using the 'bash' rather than\n'pkg' installer, and make sure to choose the intel or Apple silicon version depending on your machine.)"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"If you are on Windows"),", you want to ",(0,o.kt)("strong",{parentName:"p"},"download the linux 64-bit version")," from within your Ubuntu terminal.  (This is\nbecause we will install it into the Linux subsystem for Windows, rather onto Windows directly.) To do this, copy the\nlink to the installer, and use ",(0,o.kt)("inlineCode",{parentName:"p"},"wget")," to download it e.g."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"% wget <paste your link here>\n")),(0,o.kt)("p",null,"from the Ubuntu for Windows terminal. "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note.")," The installer is a bash (",(0,o.kt)("inlineCode",{parentName:"p"},".sh"),") file. On Mac OS X, there are also OS X package (",(0,o.kt)("inlineCode",{parentName:"p"},".pkg"),")\ninstallers available - run this instead if you want to and skip to the next section."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Because this is an installer downloaded from the internet, you should check it's the\nreal thing before installing it.  Run ",(0,o.kt)("inlineCode",{parentName:"p"},"sha256sum <miniconda filename>")," (linux or Ubuntu for Windows) or ",(0,o.kt)("inlineCode",{parentName:"p"},"shasum -a 256 <miniconda filename>")," (Mac OS X) as described  and compare the output to the SHA256 has in the output table. If it's different, don't install!"),(0,o.kt)("p",{parentName:"div"},"See ",(0,o.kt)("a",{parentName:"p",href:"https://conda.io/projects/conda/en/latest/user-guide/install/download.html#cryptographic-hash-verification"},"this\npage"),"\nfor more information."))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"To install"),", start a terminal and change directory to the downloads folder:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"on ",(0,o.kt)("strong",{parentName:"li"},"Mac OS X"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ cd Downloads\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"on ",(0,o.kt)("strong",{parentName:"li"},"Windows"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ cd /mnt/c/Users/<username>/Downloads\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"on ",(0,o.kt)("strong",{parentName:"li"},"Linux"),": probably")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ cd Downloads\n")),(0,o.kt)("p",null,"You can check what's there by running ",(0,o.kt)("inlineCode",{parentName:"p"},"ls"),".  Now run the installer:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ ./Miniconda3-latest-<platform>.sh\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You may need to make the file 'executable' first.  Run"),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre"},"$ chmod u+x ./Miniconda3-latest-<platform>.sh\n")),(0,o.kt)("p",{parentName:"div"},"to do this."))),(0,o.kt)("p",null,"You will be asked to accept the license and choose an install location. If in doubt, the defaults\ninstall to a folder called ",(0,o.kt)("inlineCode",{parentName:"p"},"miniconda3")," in your home directory, which is fine.  Say 'yes' when asked\nif you want to initialise the installer."),(0,o.kt)("h2",{id:"activating-and-deactivating-conda"},"Activating and deactivating conda"),(0,o.kt)("p",null,"If you read the blurb this command outputs, you'll see it says it is ",(0,o.kt)("strong",{parentName:"p"},"activating the conda\nenvironment by default on startup"),". This means, when you start a new terminal, conda is managing\nyour environment for you.  You'll see this because in new terminals the command prompt will look\nsomething like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"(base) <username>@<computer>:~$\n")),(0,o.kt)("p",null,"Here 'base' is the name of your conda environment."),(0,o.kt)("p",null,"You can ",(0,o.kt)("strong",{parentName:"p"},"deactivate the environment")," (going back to normal) with the ",(0,o.kt)("inlineCode",{parentName:"p"},"conda deactivate")," command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ conda deactivate\n")),(0,o.kt)("p",null,"And you can reactivate it with - you guessed it!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ conda activate\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This is a ",(0,o.kt)("strong",{parentName:"p"},"downside of using conda"),": you have to remember what environment you're in at\nany one time."))),(0,o.kt)("h2",{id:"using-conda-to-install-software"},"Using conda to install software"),(0,o.kt)("p",null,"Conda makes installing stuff easy.   But before getting started let's add two 'channels' that will\nbe really useful for bioinformatics work.  These are ",(0,o.kt)("a",{parentName:"p",href:"https://conda-forge.org"},"'conda-forge'")," which\nis a 'community-led collection of recipes ","[...]"," for the conda package manager', and 'bioconda' which\n'lets you install thousands of software packages related to biomedical research'.   The ",(0,o.kt)("a",{parentName:"p",href:"https://bioconda.github.io"},"bioconda\npage")," explains how to do this, namely, using these commands:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"conda config --add channels defaults\nconda config --add channels bioconda\nconda config --add channels conda-forge\nconda config --set channel_priority strict\n")),(0,o.kt)("p",null,"These commands set up a set of channels with priority going from the bottom to the top. So from now\non conda will look in ",(0,o.kt)("inlineCode",{parentName:"p"},"conda-forge")," first, then ",(0,o.kt)("inlineCode",{parentName:"p"},"bioconda"),", and finally the base ",(0,o.kt)("inlineCode",{parentName:"p"},"defaults")," channel\nto find software."),(0,o.kt)("h3",{id:"getting-mamba"},"Getting mamba"),(0,o.kt)("p",null,"The first thing we'll want to get is a better (faster) version of ",(0,o.kt)("inlineCode",{parentName:"p"},"conda")," itself, called ",(0,o.kt)("inlineCode",{parentName:"p"},"mamba"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ conda install mamba\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"mamba")," package lives in the ",(0,o.kt)("inlineCode",{parentName:"p"},"conda-forge")," channel.  Type 'y' and press ","<","enter",">"," to install."),(0,o.kt)("h3",{id:"installing-samtools"},"Installing samtools"),(0,o.kt)("p",null,"Now let's try installing ",(0,o.kt)("a",{parentName:"p",href:"samtools.github.io"},(0,o.kt)("inlineCode",{parentName:"a"},"samtools")),", which is a workhorse tool for handling\nnext-generation sequencing data. While you ",(0,o.kt)("em",{parentName:"p"},"can")," download the source code and compile it yourself,\nconda makes this easy. You'll want a fairly recent version, so let's get version at least ",(0,o.kt)("inlineCode",{parentName:"p"},"1.15"),"\nwhich is available from the ",(0,o.kt)("a",{parentName:"p",href:"https://bioconda.github.io"},"bioconda")," channel:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ mamba install 'samtools>=1.15'\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This may not work if you are on a Mac with Apple silicon.  If so don't worry, we'll find a\nworkaround later. For now, you can "))),(0,o.kt)("p",null,"If you look at the output you'll see that this is getting ",(0,o.kt)("inlineCode",{parentName:"p"},"htslib")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"samtools")," from bioconda, but\nalso ",(0,o.kt)("inlineCode",{parentName:"p"},"libdeflate")," from ",(0,o.kt)("inlineCode",{parentName:"p"},"conda-forge"),". Go ahead and install. Running samtools now gives you some\noutput:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ samtools\n\nProgram: samtools (Tools for alignments in the SAM format)\nVersion: 1.15.1\n\nUsage: samtools <command> [options]\n...\n")),(0,o.kt)("h2",{id:"aside-what-even-is-an-environment"},"Aside: what even is an 'environment'?"),(0,o.kt)("p",null,"UNIX figures out how to find programs and other things using so-called 'environment variables'. You\ncan see them all using the ",(0,o.kt)("inlineCode",{parentName:"p"},"env")," command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ env\n")),(0,o.kt)("p",null,"All conda is really doing is changing environment variables to point to its own copies of files."),(0,o.kt)("p",null,"For example the ",(0,o.kt)("inlineCode",{parentName:"p"},"HOME")," environment variable points at your home folder:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ echo ${HOME}\n/users/<username> (or similar)\n")),(0,o.kt)("p",null,"Let's go there now and see what's there:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ cd ${HOME}\n$ ls\n")),(0,o.kt)("p",null,"If you've followed the above, you should see that ",(0,o.kt)("inlineCode",{parentName:"p"},"conda")," has created a directory called ",(0,o.kt)("inlineCode",{parentName:"p"},"miniconda3"),"\nin there where it puts the things it installs. For example the executable programs go in ",(0,o.kt)("inlineCode",{parentName:"p"},"miniconda3/bin"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ ls miniconda3/bin\n")),(0,o.kt)("p",null,"If you look there you will see (among many other things) the ",(0,o.kt)("inlineCode",{parentName:"p"},"samtools")," executable - because we just installed it."),(0,o.kt)("p",null,"To make this work, when you activate conda it sets relevant environment variables to point into\nthis folder. In particular it adds this ",(0,o.kt)("inlineCode",{parentName:"p"},"bin")," directory to your ",(0,o.kt)("inlineCode",{parentName:"p"},"PATH")," environment variable, which the\nterminal uses to know where to look for programs. Look:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ echo ${PATH}\n/users/<username>/miniconda3/bin: (other stuff here...)\n")),(0,o.kt)("p",null,"So if you type ",(0,o.kt)("inlineCode",{parentName:"p"},"samtools"),", the first place the terminal looks is in that folder."),(0,o.kt)("p",null,"If you deactivate the conda environment, ",(0,o.kt)("inlineCode",{parentName:"p"},"PATH")," changes to remove that folder and samtools will no longer work:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ conda deactivate\n$ samtools\n\nCommand 'samtools' not found...\n")),(0,o.kt)("p",null,"However ",(0,o.kt)("inlineCode",{parentName:"p"},"samtools")," is still there on your filesystem - as it happens, you ",(0,o.kt)("em",{parentName:"p"},"can")," still run it by\nspecifying its full path:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ ./miniconda3/bin/samtools\n")),(0,o.kt)("p",null,"In other words conda isn't doing anything magical here: it's just managing your environment\nvariables for you. This is basically how 'environments' work: they are systems of environment\nvariables including ",(0,o.kt)("inlineCode",{parentName:"p"},"PATH")," that tell the UNIX shell where to look for things."))}m.isMDXComponent=!0}}]);