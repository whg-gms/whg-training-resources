"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[8307],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=u(n),d=i,h=c["".concat(l,".").concat(d)]||c[d]||m[d]||r;return n?a.createElement(h,s(s({ref:t},p),{},{components:n})):a.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,s=new Array(r);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:i,s[1]=o;for(var u=2;u<r;u++)s[u]=n[u];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2265:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:10},s="Filtering files: sort, uniq, cut, tr",o={unversionedId:"bioinformatics/command_line/filtering_files",id:"bioinformatics/command_line/filtering_files",title:"Filtering files: sort, uniq, cut, tr",description:"Pipelines are great, but you need some commands to put in them. Luckily bash contains lots of commands which can take",source:"@site/docs/bioinformatics/401_command_line/09_filtering_files.md",sourceDirName:"bioinformatics/401_command_line",slug:"/bioinformatics/command_line/filtering_files",permalink:"/whg-training-resources/bioinformatics/command_line/filtering_files",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/bioinformatics/401_command_line/09_filtering_files.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"sidebar2",previous:{title:"I/O redirection and pipelining",permalink:"/whg-training-resources/bioinformatics/command_line/pipelines"},next:{title:"Advanced topics",permalink:"/whg-training-resources/bioinformatics/command_line/appendices/"}},l={},u=[{value:"Sorting files",id:"sorting-files",level:2},{value:"Cutting columns from files",id:"cutting-columns-from-files",level:2},{value:"Finding matching (or mismatching) lines",id:"finding-matching-or-mismatching-lines",level:2},{value:"Getting unique lists of values, and counting them",id:"getting-unique-lists-of-values-and-counting-them",level:2},{value:"Transforming input",id:"transforming-input",level:2},{value:"Complex processing with grep, awk and sed",id:"complex-processing-with-grep-awk-and-sed",level:2},{value:"Conclusion",id:"conclusion",level:2}],p={toc:u},c="wrapper";function m(e){let{components:t,...n}=e;return(0,i.kt)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"filtering-files-sort-uniq-cut-tr"},"Filtering files: sort, uniq, cut, tr"),(0,i.kt)("p",null,"Pipelines are great, but you need some commands to put in them. Luckily bash contains lots of commands which can take\nstandard input, transform it, and then send the result to standard output."),(0,i.kt)("p",null,"Let's imagine we have the following file"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv \nJohn    vocals,guitars,keyboards,harmonica,bass\nPaul    vocals,bass,guitars,keyboards,drums\nGeorge  guitars,vocals,sitar,keyboards,bass\nRingo   drums,percussion,vocals\n")),(0,i.kt)("p",null,"You can get a copy of this file for yourself by running one of these commands:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"wget https://www.well.ox.ac.uk/bioinformatics/training/msc_gm/2023/data/beatles.tsv\n")),(0,i.kt)("p",null,"or "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"curl -O https://www.well.ox.ac.uk/bioinformatics/training/msc_gm/2023/data/beatles.tsv\n")),(0,i.kt)("h2",{id:"sorting-files"},"Sorting files"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"sort")," sorts its input alphabetically, numerically, or even randomly."),(0,i.kt)("p",null,"To try it, let's sort the Beatles based on their first names (from column 1):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | sort -k 1\nGeorge  guitars,vocals,sitar,keyboards,bass\nJohn    vocals,guitars,keyboards,harmonica,bass\nPaul    vocals,bass,guitars,keyboards,drums\nRingo   drums,percussion,vocals\n")),(0,i.kt)("p",null,"::tip Note\nLike other commands here, you can also use a file as input to ",(0,i.kt)("inlineCode",{parentName:"p"},"sort"),", as in "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% sort -k 1 beatles.tsv\n")),(0,i.kt)("p",null,"But we are going to keep using the pipeline syntax because it is flexible.\n:::"),(0,i.kt)("h2",{id:"cutting-columns-from-files"},"Cutting columns from files"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"cut")," lets you pick out particular columns of the input to keep."),(0,i.kt)("p",null,"For example if we only want to take the names above, then we could use cut to pick out just the first column:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | cut -f 1\nJohn\nPaul\nGeorge\nRingo\n")),(0,i.kt)("p",null,'By default, cut bases its columns on tabs, but it can use anything you like. For example let\'s get just the first\ninstrument from that list by using cut again with the "delimiter" set to a comma.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | cut -f 2 | cut -d ',' -f 1\nvocals\nvocals\nguitars\ndrums\n")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Question")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Check you understand how this works.  The first ",(0,i.kt)("inlineCode",{parentName:"p"},"cut")," in the pipeline uses tabs as a delimiter, so it cuts out the second column, which looks like 'guitars,vocals,sitar,keyboards,bass' and so on.  The second ",(0,i.kt)("inlineCode",{parentName:"p"},"cut")," then cuts out the first instrument from that list by using ",(0,i.kt)("inlineCode",{parentName:"p"},",")," as a delimiter."))),(0,i.kt)("h2",{id:"finding-matching-or-mismatching-lines"},"Finding matching (or mismatching) lines"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"grep")," finds lines that match a certain pattern."),(0,i.kt)("p",null,"For example, suppose we wanted information about just Paul.  We could do it by grepping for Paul:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep Paul\n")),(0,i.kt)("p",null,"We could also use the ",(0,i.kt)("inlineCode",{parentName:"p"},"-v")," (or ",(0,i.kt)("inlineCode",{parentName:"p"},"--invert-match"),") option to find out about all the beatles ",(0,i.kt)("em",{parentName:"p"},"except")," Paul:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep -v Paul\n")),(0,i.kt)("p",null,"Do all beatles sing?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep vocals\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"grep")," is actually a sophisticated tool that can find complex matches - we'll come back to this below."),(0,i.kt)("h2",{id:"getting-unique-lists-of-values-and-counting-them"},"Getting unique lists of values, and counting them"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uniq")," removes duplicate lines from standard input.  Often this is best if you sort it first.\nFor example, to get a unique list of first instruments we could extend the above with a call to ",(0,i.kt)("inlineCode",{parentName:"p"},"uniq"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | cut -f 2 | cut -d ',' -f 1 | uniq\nvocals\nguitars\ndrums\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"uniq")," also has a very useful option ",(0,i.kt)("inlineCode",{parentName:"p"},"-c"),", which also counts the "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | cut -f 2 | cut -d ',' -f 1 | uniq -c\n   2 vocals\n   1 guitars\n   1 drums\n")),(0,i.kt)("h2",{id:"transforming-input"},"Transforming input"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"tr")," translates characters into others."),(0,i.kt)("p",null,"Specifically, if you give it two equal length strings, it will swap characters in the first string in standard input for the\ncorresponding characters from the second string."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% echo veryinsecurepassword | tr osi 05!\nvery!n5ecurepa55w0rd\n")),(0,i.kt)("p",null,"It can also be used to change the case of a string"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% echo veryinsecurepassword | tr '[:lower:]' '[:upper:]'\nVERYINSECUREPASSWORD\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"tr")," also has an option ",(0,i.kt)("inlineCode",{parentName:"p"},"-d")," which means 'delete these characters':"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% echo veryinsecurepassword | tr -d 'aeiou'\nvrynscrpsswrd\n")),(0,i.kt)("p",null,"As you can see, you can do a lot by combining these simple tools together with pipes."),(0,i.kt)("h2",{id:"complex-processing-with-grep-awk-and-sed"},"Complex processing with grep, awk and sed"),(0,i.kt)("p",null,"As a last part to this tutorial, we will mention three programs that are sophisticated tools in their own right. They\nare well worth looking into in detail, but we will use them in fairly simple ways in this module. Here are a\nfew basic recipes that you can use with each of them without needing to understand them deeply."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"grep")," extracts lines containing a pattern")),(0,i.kt)("p",null,"You could use it to see who in the Beatles plays keyboards:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep keyboards\nJohn    vocals,guitars,keyboards,harmonica,bass\nPaul    vocals,bass,guitars,keyboards,drums\nGeorge  guitars,vocals,sitar,keyboards,bass\n")),(0,i.kt)("p",null,"or the names of Beatles who play keyboards and sing:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep keyboards | grep vocals\n")),(0,i.kt)("p",null,"::tip Note\n",(0,i.kt)("inlineCode",{parentName:"p"},"grep")," is actually quite a bit more sophisticated than this - the pattern is really a ",(0,i.kt)("em",{parentName:"p"},"regular expression"),". We won't go\ninto detail, but for example, here is a command which only finds lines with 'bass' right at the end of the line:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% cat beatles.tsv | grep 'bass$'\n")),(0,i.kt)("p",null,"(The ",(0,i.kt)("inlineCode",{parentName:"p"},"$")," in a regular expression means 'match the end of the line')\n:::"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"awk")," filter lines based on the contents of columns")),(0,i.kt)("p",null,"In this module we'll also make very simple use of ",(0,i.kt)("inlineCode",{parentName:"p"},"awk")," to find values in specific columns.",(0,i.kt)("br",{parentName:"p"}),"\n","(This is different to ",(0,i.kt)("inlineCode",{parentName:"p"},"grep")," that will search for patterns in the whole line.)\nFor example let's pick out just Paul using his name in column one"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat beatles.tsv | awk '$1 == \"Paul\"'\nPaul    vocals,bass,guitars,keyboards,drums\n")),(0,i.kt)("p",null,"Here the '$1' means 'look at column 1' and the ",(0,i.kt)("inlineCode",{parentName:"p"},'== "Paul"'),' means \'is equal to "Paul".  (We have to put single quotes\naround the whole thing to make sure all this is interpreted by ',(0,i.kt)("inlineCode",{parentName:"p"},"awk"),", not the command line itself.)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Finally, ",(0,i.kt)("inlineCode",{parentName:"li"},"sed")," can parse and transform text in a more sophisticated way than ",(0,i.kt)("inlineCode",{parentName:"li"},"tr"))),(0,i.kt)("p",null,"For example, it can be used to substitute some text with other text using the 's' command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ cat beatles.tsv | sed 's/keyboards/piano/'\nJohn    vocals,guitars,piano,harmonica,bass\nPaul    vocals,bass,guitars,piano,drums\nGeorge  guitars,vocals,sitar,piano,bass\nRingo   drums,percussion,vocals\n")),(0,i.kt)("p",null,"By putting together pipelines made out of these commands you can perform complex sorting, filtering, and transformations\non files."),(0,i.kt)("h2",{id:"conclusion"},"Conclusion"),(0,i.kt)("p",null,"Congratulations!  You reached the end of this tutorial.  Remember you can see everything you've run so far by typing"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"% history\n")),(0,i.kt)("p",null,"Now try some ",(0,i.kt)("a",{parentName:"p",href:"/whg-training-resources/bioinformatics/command_line/questions"},"test questions")," or read some more ",(0,i.kt)("a",{parentName:"p",href:"./appendices/"},"advanced topics"),"."))}m.isMDXComponent=!0}}]);