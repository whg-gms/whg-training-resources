"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[5375],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(a),c=r,m=d["".concat(l,".").concat(c)]||d[c]||h[c]||i;return a?n.createElement(m,o(o({ref:t},u),{},{components:a})):n.createElement(m,o({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},659:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const i={sidebar_position:4},o="Viewing reads",s={unversionedId:"sequence_data_analysis/IGV/Exploring_reads_in_IGV",id:"sequence_data_analysis/IGV/Exploring_reads_in_IGV",title:"Viewing reads",description:"You should now have load some data into IGV (if not, go and do that now.)",source:"@site/docs/sequence_data_analysis/IGV/Exploring_reads_in_IGV.md",sourceDirName:"sequence_data_analysis/IGV",slug:"/sequence_data_analysis/IGV/Exploring_reads_in_IGV",permalink:"/whg-training-resources/sequence_data_analysis/IGV/Exploring_reads_in_IGV",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/sequence_data_analysis/IGV/Exploring_reads_in_IGV.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"sidebar9",previous:{title:"Exploring Reads in IGV",permalink:"/whg-training-resources/sequence_data_analysis/IGV/"},next:{title:"A sequence data pipelining challenge!",permalink:"/whg-training-resources/sequence_data_analysis/building_an_ngs_pipeline/"}},l={},p=[{value:"Basics",id:"basics",level:2},{value:"Looking at SNPs",id:"looking-at-snps",level:2},{value:"Examining larger structural variants",id:"examining-larger-structural-variants",level:2},{value:"Examining structural variant breakpoints",id:"examining-structural-variant-breakpoints",level:2},{value:"Figuring out the structural variant structure",id:"figuring-out-the-structural-variant-structure",level:2},{value:"Summary",id:"summary",level:2}],u={toc:p},d="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(d,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"viewing-reads"},"Viewing reads"),(0,r.kt)("p",null,"You should now have load some data into IGV (if not, go and ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/IGV/#loading-data"},"do that now"),".)\nYou'll probably see something like this:"),(0,r.kt)("p",null,"To see the reads you will need to zoom into a location on the genome. For example, let's zoom into the gene that\nharbours the famous chloroquine resistance mutation, ",(0,r.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/record/gene/PF3D7_0709000"},"Chloroquine resistance transporter\n(",(0,r.kt)("em",{parentName:"a"},"CRT"),")"),". To search for it you will need its ID, which is\n",(0,r.kt)("inlineCode",{parentName:"p"},"PF3D7_0709000"),". Voila! Some reads."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"IGV hints")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This is a good point to try a few options to get used to IGV."),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For paired-end data, try the 'view as pairs' option. It can be found in the context menu, obtained by right-clicking\nanywhere on the track.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"If you don't like how reads are displayed, try 'collapsed', 'expanded', or 'squished' from the context menu.  Which one do you like best?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Try clicking on a read.  What is all that info?  Where does it come from?  What does it mean?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Try moving around and zooming in/out.  ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"There's also a ",(0,r.kt)("inlineCode",{parentName:"p"},"genes")," track - it can be annoying when it is squished.  Try right-clicking and choose 'expanded' to see the\ngenes."))))),(0,r.kt)("h2",{id:"basics"},"Basics"),(0,r.kt)("p",null,"Scroll around a bit to look at the reads."),(0,r.kt)("p",null,"Can you find:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"a sequencing error?"),(0,r.kt)("li",{parentName:"ul"},"a SNP?"),(0,r.kt)("li",{parentName:"ul"},"an insertion / deletion variant?")),(0,r.kt)("p",null,"What makes you think so?"),(0,r.kt)("p",null,":::"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"By default you are looking at all reads (including those that didn't map very well.)  There's an option hidden away\nunder ",(0,r.kt)("inlineCode",{parentName:"p"},"Preferences")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Alignment")," that lets you set a mapping quality threshold.  A good default value to put here is\n20 (but remember that by doing this you are filtering some reads!)"))),(0,r.kt)("h2",{id:"looking-at-snps"},"Looking at SNPs"),(0,r.kt)("p",null,"Let's try looking some SNPs"),(0,r.kt)("p",null,"The mutation that causes ",(0,r.kt)("a",{parentName:"p",href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2954758/"},"chloroquine resistance")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"CRT\nK76>T"),", at ",(0,r.kt)("inlineCode",{parentName:"p"},"Pf3D7_07_v3:403,625"),". (It actually involves a small haplotype including other nearby mutations)."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Questions")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Can you find these mutations?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Parasites with the non-reference allele are resistant to chloroquine - are your parasites resistant or susceptible?  (NB. all these samples come from ",(0,r.kt)("a",{parentName:"p",href:"https://www.google.com/maps/place/Democratic+Republic+of+the+Congo/@-3.9835365,12.6862829,5z/data=!3m1!4b1!4m5!3m4!1s0x1979facf9a7546bd:0x4c63e5eac93f141!8m2!3d-4.038333!4d21.758664"},"Democratic Republic of The Congo"),").")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Zoom into this location to look at the sequence.  Can you figure out the amino acid change(s)?")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"How many reads support this in each sample?  What alleles do they carry?  What are their IDs?  Are they well mapped?\nAre they properly paired?  Where is their pair?"))),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Note.")," 'properly paired' means that the two reads in the pair align to the same region in the right orientation, and roughly fall within the distribution of insert sizes inferred from all the read pairs in the data.  The aligner (",(0,r.kt)("inlineCode",{parentName:"p"},"bwa")," in this case) sets a flag in the BAM file to reflect this."),(0,r.kt)("h2",{parentName:"div",id:"looking-at-insertions-and-deletions"},"Looking at insertions and deletions"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Question.")," The variants above are single nucleotide polymorphisms (SNPs) - or rather multiple nucleotide polymorphisms (MNPs) since several come together.  What about other types of variation?  Scroll around a bit and see if you can find a deletion.  (If stuck, try looking around the gene ",(0,r.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/search?q=PF3D7_0220300"},(0,r.kt)("inlineCode",{parentName:"a"},"PF3D7_0215300")),".  What read evidence supports this deletion?"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Note.")," There might also be insertions, which are denoted by a purple bar across a read in IGV.  Can you find any of these?"),(0,r.kt)("h2",{parentName:"div",id:"the-trouble-with-mapping-is"},"The trouble with mapping is..."),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"Question.")," If you scroll around a bit, after a while you'll come across regions where no reads (or very few reads)\nseem to align.  Can you find one?  What could cause this? "))),(0,r.kt)("p",null,"If you can't find any, try the ends of chromosomes, or the gene ",(0,r.kt)("inlineCode",{parentName:"p"},"PF3D7_0223500")," (which encodes one of the highly\npolymorphic / duplicated 'var' genes.)"),(0,r.kt)("p",null,":::"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Hint.")," You could also try searching for the relevant piece of genome sequence using ",(0,r.kt)("a",{parentName:"p",href:"https://blast.ncbi.nlm.nih.gov/Blast.cgi"},"NCBI\nBLAST"),".  For example, I tried this for one such location:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ samtools faidx data/reference/Pf3D7_v3.fa.gz Pf3D7_07_v3:343,180-343,380\n>Pf3D7_07_v3:343,180-343,380\ntatatatatatatatatatatatatatatatatatatataaatatatatatatgtatgta\ntgtatgtaatattttagtgcaaaaaaaaaaaaaaaaaaaaaaaaaaagtatataatgaaa\naattattatatatatatatattatatatatatatatatatatatatatatatatatatat\natatatatatatatatatata\n")),(0,r.kt)("p",null,"and then pasted the above into the ",(0,r.kt)("a",{parentName:"p",href:"https://blast.ncbi.nlm.nih.gov/Blast.cgi"},"Nucleotide BLAST page"),".  (Another version of this can be found ",(0,r.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/search/transcript/UnifiedBlast"},"on PlasmoDB"),".  ",(0,r.kt)("strong",{parentName:"p"},"Note.")," you may need to turn off the 'low complexity region' filter to get useful results."),(0,r.kt)("h2",{id:"examining-larger-structural-variants"},"Examining larger structural variants"),(0,r.kt)("p",null,"Let's have a look at a larger structural variant.  Zoom your IGV to the region around the gene ",(0,r.kt)("a",{parentName:"p",href:"https://plasmodb.org/plasmo/app/record/gene/PF3D7_1127000"},(0,r.kt)("inlineCode",{parentName:"a"},"Pf3D7_1127000")),".  And zoom out a bit so you can see the whole region including the two flanking genes."),(0,r.kt)("p",null,"The samples from this tutorial were chosen because some of them contain a large structural variant in this region. "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Challenge.")," Can you find this structural variant in one or more of the samples you've loaded?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Hints.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"One way to find structural variants is by looking at their effects on copy number (i.e. on read coverage.)  Do any samples have unusual copy number profiles?  (NB. this is generally easier in human sequence data because in P.falciparum the coverage varies a lot anyway due to varying AT content.)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Your reads are paired-end reads.  If the genome has a different structure to the reference, then these might not align close together in the right orientation or insert size.  Can you find reads like this?  (Hint: the 'view as pairs', 'group by' and/or 'color by' options are very useful here.)  What is their orientation - are the read pairs the 'right' way round or the 'wrong' way round?  What does this mean?  Are these single reads or are they supported by others?"))),(0,r.kt)("h2",{id:"examining-structural-variant-breakpoints"},"Examining structural variant breakpoints"),(0,r.kt)("p",null,"By a 'breakpoint' we mean the points where the segments of the sequenced genome are connected together in a different way to the reference genome.  The long, wrongly oriented / wrong insert size reads above potentially span these breakpoints."),(0,r.kt)("p",null,"A good way to look at this is as follows.  First zoom into one of the reads in the pair. Now right-click on a read and choose 'View mate region in split screen'.  Voila!  You are now looking at both ends of the same read pair."),(0,r.kt)("p",null,"To take this further there is an additional option.  If the read in the pair actually crosses a structural variant breakpoint, it could be that the end of the read does not align well.  If so it will typically be 'soft-clipped' by the aligner.  (The ",(0,r.kt)("a",{parentName:"p",href:"https://sites.google.com/site/bioinformaticsremarks/bioinfo/sam-bam-format/what-is-a-cigar"},(0,r.kt)("inlineCode",{parentName:"a"},"CIGAR string"))," for the alignment will have a sequence of 'S's at the end).  Under ",(0,r.kt)("inlineCode",{parentName:"p"},"Preferences")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"Alignments")," there is an option 'Show soft-clipped bases' to visualise these.  Go and turn this on.  Does this help figure out the basepair location of the possible breakpoint?"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"NB.")," In the current data this works best for the reads at ",(0,r.kt)("inlineCode",{parentName:"p"},"Pf3D7_11_v3:1,058,745-1,058,915")," - if you processed the full coverage data then it might work at all the breakpoints."),(0,r.kt)("h2",{id:"figuring-out-the-structural-variant-structure"},"Figuring out the structural variant structure"),(0,r.kt)("p",null,"::tip Extra hard challenge"),(0,r.kt)("p",null,"Figure out the structure of the structural variant genomes from these reads."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," Good luck!  This really is difficult."),(0,r.kt)("p",null,"If you want some inspiration, see Figure 6 of ",(0,r.kt)("a",{parentName:"p",href:"https://doi.org/10.1126/science.aam6393"},"this paper on the Dantu blood group")," to see a similar process applied to a human structural variant."),(0,r.kt)("p",null,":::"),(0,r.kt)("h2",{id:"summary"},"Summary"),(0,r.kt)("p",null,"Congratulations!  You are now an IGV expert!"))}h.isMDXComponent=!0}}]);