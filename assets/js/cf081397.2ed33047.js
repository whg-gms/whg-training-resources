"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[353],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},h="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),h=c(n),u=r,m=h["".concat(l,".").concat(u)]||h[u]||p[u]||s;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,o=new Array(s);o[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[h]="string"==typeof e?e:r,o[1]=i;for(var c=2;c<s;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4434:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const s={sidebar_position:8},o="Appendix 1: Paired-end sequencing in theory and practice",i={unversionedId:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory",id:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory",title:"Appendix 1: Paired-end sequencing in theory and practice",description:"What paired-end sequence data should look like",source:"@site/docs/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory.md",sourceDirName:"sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis",slug:"/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Short_read_theory.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"sidebar9",previous:{title:"Bonus tutorial: how accurate is Illumina sequencing?",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/De_novo_error_rate_estimation"},next:{title:"Appendix 2: understanding sequence duplication levels",permalink:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/duplicates"}},l={},c=[{value:"What paired-end sequence data should look like",id:"what-paired-end-sequence-data-should-look-like",level:2},{value:"What paired-end data actually looks like",id:"what-paired-end-data-actually-looks-like",level:2},{value:"So what goes wrong?",id:"so-what-goes-wrong",level:2},{value:"The fragments are too short",id:"the-fragments-are-too-short",level:3},{value:"The fragments are too long",id:"the-fragments-are-too-long",level:3},{value:"The adapter chemistry goes wrong",id:"the-adapter-chemistry-goes-wrong",level:3},{value:"The library has too little input DNA",id:"the-library-has-too-little-input-dna",level:3},{value:"There is spillover between clusters",id:"there-is-spillover-between-clusters",level:3},{value:"Incorporation of bases gets out of sync",id:"incorporation-of-bases-gets-out-of-sync",level:3},{value:"The fragmentation / chemistry introduces biases",id:"the-fragmentation--chemistry-introduces-biases",level:3},{value:"Next steps",id:"next-steps",level:2}],d={toc:c},h="wrapper";function p(e){let{components:t,...s}=e;return(0,r.kt)(h,(0,a.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"appendix-1-paired-end-sequencing-in-theory-and-practice"},"Appendix 1: Paired-end sequencing in theory and practice"),(0,r.kt)("h2",{id:"what-paired-end-sequence-data-should-look-like"},"What paired-end sequence data should look like"),(0,r.kt)("p",null,"You'll know that typical short-read datasets are made up of pairs of reads representing sequencing\nof both ends of short DNA fragments. The basic model is that we should be generating short DNA\nfragments that get read from either end like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"        READ 1:    --------\x3e \n  DNA FRAGMENT: 5' ------------------------------------ 3'\n        READ 2:                               <--------\n")),(0,r.kt)("p",null,"Read 1 and 2 form what is called a ",(0,r.kt)("strong",{parentName:"p"},"read pair")," (and this is ",(0,r.kt)("strong",{parentName:"p"},"paired-end sequencing"),"); this is\nimportant for analysis because we know that they came from the same fragment."),(0,r.kt)("p",null,"Typical data contains paired-end reads from millions of number of fragments that are of reasonable\nsize (often around 400-500bp). In an ideal world these would be randomly sampled from around the\ngenome of interest, so generating approximately uniform coverage."),(0,r.kt)("h2",{id:"what-paired-end-data-actually-looks-like"},"What paired-end data actually looks like"),(0,r.kt)("p",null,"In real data things are not quite so simple. To understand this you have to know a bit about the\nchemistry. It works like this (I'm describing Illumina sequencing here, other technologies may be\nsubtly different):"),(0,r.kt)("p",null,"First, the fragment gets extra ",(0,r.kt)("em",{parentName:"p"},"adapter sequences")," ligated onto the end:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  FRAGMENT WITH ADAPTERS: 5' ========-------------======= 3'\n")),(0,r.kt)("p",null,"The fragment is often called the ",(0,r.kt)("strong",{parentName:"p"},"insert"),', since it is "inserted" between the adapter sequences.'),(0,r.kt)("p",null,"The adapters are themselves structured: moving outward from the fragment, they have a ",(0,r.kt)("em",{parentName:"p"},"primer\nsequence")," (that tells the polymerase where to start sequencing), an ",(0,r.kt)("em",{parentName:"p"},"index")," that identifies the\nsample, and then a specific sequence whose job is to anneal to the oligos on the flowcell. So they\nlook something like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"  FRAGMENT WITH ADAPTERS: 5' OOIIIPPPP--------------PPPPIIIOO 3'\n")),(0,r.kt)("p",null,"Where ",(0,r.kt)("inlineCode",{parentName:"p"},"O")," = oligo-binding sequence, ",(0,r.kt)("inlineCode",{parentName:"p"},"I")," = the sample index, and ",(0,r.kt)("inlineCode",{parentName:"p"},"P")," = the sequencing primer that\nindicates the sequencing start point. (The sample index is used to de-multiplex reads from\ndifferent samples run on the same lane at the same time - it is read in seperate index cycles.)"),(0,r.kt)("p",null,"If all goes well, the sequencing starts from just after the read 1 primer and ends after a fixed\nnumber of cycles (often 100-150 for high-throughput sequencers). Then the fragment is reversed (by\na slightly complicated process) and read 2 is read in the same way. So we should get this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                  READ 1:             -----\x3e \n  FRAGMENT WITH ADAPTERS: 5' OOIIIPPPP------------------PPPPIIIOO 3'\n                  READ 2:                         <-----\n")),(0,r.kt)("p",null,"Here's another picture of the same thing from ",(0,r.kt)("a",{parentName:"p",href:"https://support.illumina.com/bulletins/2016/04/adapter-trimming-why-are-adapter-sequences-trimmed-from-only-the--ends-of-reads.html"},"Illumina's page on adapter\ntrimming"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(9447).Z,width:"896",height:"410"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," What actually ",(0,r.kt)("em",{parentName:"p"},"are")," the adapter sequences? This depends on the kit, but you can find out\nif you want to - for Illumina has a\n",(0,r.kt)("a",{parentName:"p",href:"https://support-docs.illumina.com/SHARE/AdapterSeq/Content/SHARE/AdapterSeq/AdapterSequencesIntro.htm"},"list of adapter and index barcodes"),".\nTools like ",(0,r.kt)("inlineCode",{parentName:"p"},"fastqc")," use these known sequences to look for adapter contamination."),(0,r.kt)("p",null,"You can also watch ",(0,r.kt)("a",{parentName:"p",href:"https://youtu.be/fCd6B5HRaZ8"},"Illumina's short video on the sequencing process"),"."),(0,r.kt)("p",null,"To generate enough intensity for imaging, the ligated fragments above undergo\n",(0,r.kt)("em",{parentName:"p"},"amplification on the flowcell")," that generates multiple copies of each fragment - called a\n",(0,r.kt)("strong",{parentName:"p"},"cluster"),". This process keeps the fragments local (they stay within the imaging 'tile') so that\nthey are imaged together, generating the output sequence data."),(0,r.kt)("p",null,"Finally, the sequencer proceeds to sequence each read in ",(0,r.kt)("strong",{parentName:"p"},"cycles"),". In each cycle, travelling in\nfrom the primer, the polymerase incorporates a single flourescently-labelled base complementary to\nthe insert, and an image is taken to capture the colour of the incorporated base. Then, in the next\ncycle the flourescent label is removed which allows the subsequent base to be incorporated, and so\non until the read is complete."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," See the ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Useful_links"},"useful links page")," for links to other resources on sequencing."),(0,r.kt)("h2",{id:"so-what-goes-wrong"},"So what goes wrong?"),(0,r.kt)("p",null,"Well here are a few common issues:"),(0,r.kt)("h3",{id:"the-fragments-are-too-short"},"The fragments are too short"),(0,r.kt)("p",null,"If the fragments are too short you'll start to see ",(0,r.kt)("strong",{parentName:"p"},"overlapping reads"),", ",(0,r.kt)("strong",{parentName:"p"},"adapter contamination"),",\nor maybe ",(0,r.kt)("strong",{parentName:"p"},"failed sequencing bases"),"."),(0,r.kt)("p",null,"This is because the reads may start to look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                  READ 1:             --------\x3e \n  FRAGMENT WITH ADAPTERS: 5' OOIIIPPPP--------------PPPPIIIOO 3'\n                  READ 2:                  <--------\n")),(0,r.kt)("p",null,"or this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                  READ 1:             --------\x3e \n  FRAGMENT WITH ADAPTERS: 5' OOIIIPPPP---PPPPIIIOO 3'\n                  READ 2:       <--------\n")),(0,r.kt)("p",null,"Or maybe even this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"                  READ 1:                --------------\x3e \n  FRAGMENT WITH ADAPTERS: 5'    OOIIIPPPP--PPPPIIIOO\n                  READ 2:    <-------------\n")),(0,r.kt)("p",null,"The reads end up with bits of overlapping sequence, read-through into the adapters, or even read\nright off the end of the sequence."),(0,r.kt)("p",null,"(What happens in the last case depends a bit on which sequencer is being used. Recent machines such\nas the Novaseq use a '2-color' imaging process, which does not distinguish between a G base and a\nlack of intensity, so this type of read-through leads to long sequences of apparent 'G' bases in\nthe reads.  See the ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Quality_control"},"QC page")," for some examples."),(0,r.kt)("h3",{id:"the-fragments-are-too-long"},"The fragments are too long"),(0,r.kt)("p",null,"Having too-long fragments doesn't cause the ",(0,r.kt)("em",{parentName:"p"},"same")," problems as too-short fragments, but it does turn out to hurt read 2.\nIn particular the efficiency of the turnover step (where the fragments get reversed before read 2 is sequenced) seems to\ndepend heavily on having fragments that are around 500bp in length or less."),(0,r.kt)("p",null,"As fragments get longer, it's typical to see ",(0,r.kt)("a",{parentName:"p",href:"https://www.nature.com/articles/s41598-019-39076-7#:~:text=Abstract,error%20rate%20below%201%2F1000"},"elevated error rates in read 2"),"."),(0,r.kt)("h3",{id:"the-adapter-chemistry-goes-wrong"},"The adapter chemistry goes wrong"),(0,r.kt)("p",null,"There's a bit of asymmetry in the process between the two reads. This is because if the read 1\nchemistry doesn't work out, then the fragment may not anneal to the flowcell so won't start a cluster at all. But if read 2\nchemistry doesn't work out we'll get artifacts in the second read. Some examples of that are ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Quality_control"},"on\nthe QC page")," where a fraction of read pairs read 2 entirely composed of ",(0,r.kt)("inlineCode",{parentName:"p"},"G"),"\nbases. (As in\n",(0,r.kt)("a",{parentName:"p",href:"https://www.well.ox.ac.uk/~gav/projects/oxford_statgen_summer_school/sequence_data_analysis/fastqc_examples/human/HV31-illumina_novaseq_2_fastqc.html#M9"},"this sample"),",\nsequenced during workflow testing, for which I presume the read 2 primers are not properly ligated leading to low intensities for\nthe second read."),(0,r.kt)("h3",{id:"the-library-has-too-little-input-dna"},"The library has too little input DNA"),(0,r.kt)("p",null,"If the library has too little input DNA then we will end up sequencing the same fragments over and\nover again - generating ",(0,r.kt)("strong",{parentName:"p"},"duplicate reads"),"."),(0,r.kt)("p",null,"This occurs because of duplication of the same fragments by the PCR process, and it means we will\nget high levels of ",(0,r.kt)("strong",{parentName:"p"},"duplicate reads"),". (This is often referred to as a 'low diversity' library,\nbut note this is not referring to ",(0,r.kt)("em",{parentName:"p"},"genetic diversity")," or the actual genetic makeup of the sample -\nit is just about about how well the genome is represented by random fragments.)"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note.")," Some level of duplication is expected anyway, both by random chance of where fragments\nare sequenced, and because genomes contain repetitive sequence. Howeer, an important feature of\nartifactual duplicates above is that they sequence the ",(0,r.kt)("strong",{parentName:"p"},"exact same fragment"),", so both read 1 and\nread 2 will appear to be duplicated. Because there is generally a spread of fragment sizes, this is\nvery unlikely even for high-coverage sequencing."),(0,r.kt)("h3",{id:"there-is-spillover-between-clusters"},"There is spillover between clusters"),(0,r.kt)("p",null,"Even with PCR duplicates, some clusters on the flowcell may end up large enough that they get\nimaged as two or more clusters. (Another version of this is that the original amplified fragment\nmoves off and forms another nearby cluster.) This has the effect of also generating duplicate reads,\nknown as ",(0,r.kt)("strong",{parentName:"p"},"optical duplicates"),". "),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The way these are detected is as identical or very similar reads that lie in nearby physical locations on the flowcell. "))),(0,r.kt)("p",null,"These duplicates can occur even if the library preparation steps do not use PCR amplification. See\n",(0,r.kt)("a",{parentName:"p",href:"https://sequencing.qcfail.com/articles/illumina-patterned-flow-cells-generate-duplicated-sequences/"},"sequencing.qcfail.com"),"\nfor an analysis of this."),(0,r.kt)("h3",{id:"incorporation-of-bases-gets-out-of-sync"},"Incorporation of bases gets out of sync"),(0,r.kt)("p",null,"The sequencing process relies on generating large clusters of identical DNA molecules that are all\nimaged together. However, as the process proceeds along the read, it can happen that the different\ncopies get out of 'sync'. As the read proceeds this affects a larger and larger subset of the\ncopies leading to ",(0,r.kt)("strong",{parentName:"p"},"worse sequencing toward the end of the read"),". This is often reflected in the\nlowered base qualitites."),(0,r.kt)("h3",{id:"the-fragmentation--chemistry-introduces-biases"},"The fragmentation / chemistry introduces biases"),(0,r.kt)("p",null,"It is thought that common fragmentation methods themselves introduce bias in the DNA content at the\nstart of the fragments. It is generally true that there is some bias in the GC content of the first\nfew bases in the reads, as seen in this file."),(0,r.kt)("h2",{id:"next-steps"},"Next steps"),(0,r.kt)("p",null,"Now get back ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Pipeline_outline#the-practical-in-a-nutshell"},"back to the practical"),", or\nsee the ",(0,r.kt)("a",{parentName:"p",href:"/whg-training-resources/sequence_data_analysis/introduction_to_next_generation_sequencing_data_analysis/Quality_control/#a-survey-of-sequencing-performance"},"examples on the QC page"),"."))}p.isMDXComponent=!0},9447:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/PEcell2-4d18c1f63495bb083fb5971c0d0e9fab.png"}}]);