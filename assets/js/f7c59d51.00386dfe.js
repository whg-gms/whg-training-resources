"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[4339],{3905:(e,n,a)=>{a.d(n,{Zo:()=>c,kt:()=>m});var t=a(7294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=t.createContext({}),d=function(e){var n=t.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},c=function(e){var n=d(e.components);return t.createElement(l.Provider,{value:n},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},g=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=d(a),g=i,m=p["".concat(l,".").concat(g)]||p[g]||u[g]||r;return a?t.createElement(m,s(s({ref:n},c),{},{components:a})):t.createElement(m,s({ref:n},c))}));function m(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=a.length,s=new Array(r);s[0]=g;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[p]="string"==typeof e?e:i,s[1]=o;for(var d=2;d<r;d++)s[d]=a[d];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}g.displayName="MDXCreateElement"},3214:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var t=a(7462),i=(a(7294),a(3905));const r={},s="Getting setup",o={unversionedId:"data_visualisation/visualising_rna-seq_data/getting_setup",id:"data_visualisation/visualising_rna-seq_data/getting_setup",title:"Getting setup",description:"Loading libraries",source:"@site/docs/data_visualisation/visualising_rna-seq_data/002_getting_setup.md",sourceDirName:"data_visualisation/visualising_rna-seq_data",slug:"/data_visualisation/visualising_rna-seq_data/getting_setup",permalink:"/whg-training-resources/data_visualisation/visualising_rna-seq_data/getting_setup",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/data_visualisation/visualising_rna-seq_data/002_getting_setup.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"sidebar3",previous:{title:"Visualise RNA-seq data in R",permalink:"/whg-training-resources/data_visualisation/visualising_rna-seq_data/"},next:{title:"Visualising the data",permalink:"/whg-training-resources/data_visualisation/visualising_rna-seq_data/visualising"}},l={},d=[{value:"Loading libraries",id:"loading-libraries",level:2},{value:"Loading data",id:"loading-data",level:2},{value:"Checking the expression data",id:"checking-the-expression-data",level:2},{value:"Checking the gene annotations",id:"checking-the-gene-annotations",level:2}],c={toc:d},p="wrapper";function u(e){let{components:n,...a}=e;return(0,i.kt)(p,(0,t.Z)({},c,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"getting-setup"},"Getting setup"),(0,i.kt)("h2",{id:"loading-libraries"},"Loading libraries"),(0,i.kt)("p",null,"We'll begin by loading a series of R libraries containing useful functions for data visualisation. If you have not yet installed these libraries, you can do so by running the following code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},'install.packages("tidyverse")\ninstall.packages("matrixStats")\ninstall.packages("reshape2")\ninstall.packages("pheatmap")\ninstall.packages("ggpubr")\ninstall.packages("ggrepel")\ninstall.packages("hexbin")\n')),(0,i.kt)("p",null,"Let's now load the libraries."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"library(tidyverse)\nlibrary(matrixStats)\nlibrary(reshape2)\nlibrary(pheatmap)\nlibrary(ggpubr)\nlibrary(ggrepel)\nlibrary(hexbin)\n")),(0,i.kt)("h2",{id:"loading-data"},"Loading data"),(0,i.kt)("p",null,"We will now load the GTEx gene expression table, as well as a table containing annotations for each of the genes measured in the study.  The data can be found in ",(0,i.kt)("a",{parentName:"p",href:"https://www.well.ox.ac.uk/~gav/projects/whg-training-resources/data/data_visualisation/visualising_rna-seq_data/"},"this folder")," - download both files now."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"We recommend working in a new folder for this - for example by running this in your terminal:"),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre"},"mkdir rna-seq_practical\ncd rna-seq_practical\ncurl -O https://www.well.ox.ac.uk/~gav/projects/whg-training-resources/data/data_visualisation/visualising_rna-seq_data/GTEx-v8-RNAseq_mean-TPM_QCed.tsv\ncurl -O https://www.well.ox.ac.uk/~gav/projects/whg-training-resources/data/data_visualisation/visualising_rna-seq_data/GTEx_gene-annotations.tsv\n")),(0,i.kt)("p",{parentName:"div"},"This might take a minute or so to download."),(0,i.kt)("p",{parentName:"div"},"Now make sure your R session is working in the same directory using ",(0,i.kt)("inlineCode",{parentName:"p"},"setwd()")," or the ",(0,i.kt)("inlineCode",{parentName:"p"},"Session -> Set Working Directory")," menu option in RStudio."))),(0,i.kt)("p",null,"The data files are in tab-separated value (TSV) format, which means they are composed of columns, separated by tabular spaces. You can read this type of file into R by using the read.table() function, as specified below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},'library( tidyverse )\ngtex <- read_tsv( "GTEx-v8-RNAseq_mean-TPM_QCed.tsv" )\ngene_annotations <- read_tsv( "GTEx_gene-annotations.tsv" )\n')),(0,i.kt)("h2",{id:"checking-the-expression-data"},"Checking the expression data"),(0,i.kt)("p",null,"To check this worked, let's have a closer look at the main expression table by previewing the first 10 rows and columns.\nNote how each row corresponds to a gene and each column corresponds to a tissue. Entries in the table contain the\nexpression levels of each gene in each tissue in TPM units."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"print(gtex)\n")),(0,i.kt)("p",null,"You should see something like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"# A tibble: 14,240 \xd7 55\n   gene_name Adipose_Subcutaneous Adipose_Visceral_Omentum Adrenal_Gland Artery_Aorta Artery_Coronary Artery_Tibial Bladder Brain_Amygdala\n   <chr>                    <dbl>                    <dbl>         <dbl>        <dbl>           <dbl>         <dbl>   <dbl>          <dbl>\n 1 LINC01128                7.44                     7.80           4.03        8.85            8.72         11.1      7.62          2.98 \n 2 LINC00115                4.49                     3.42           2.75        6.23            5.94          7.82     7.57          1.45 \n 3 SAMD11                   0.476                    2.93           3.78        5.72            3.10          7.93    19.1           0.533\n 4 NOC2L                   52.9                     48.2           37.2        55.5            51.9          62.6     71.9          18.3  \n 5 KLHL17                   9.68                     8.97           7.89       13.9            13.4          10.7     17.6           3.05 \n 6 PLEKHN1                  0.560                    0.648          1.93        0.744           0.868         0.718    4.22          0.107\n 7 HES4                    21.8                     24.2            2.91       46.6            64.6          98.4     33.1          16.7  \n 8 ISG15                   36.6                     35.0           13.5        50.8            43.7          50.4     33.0          43.6  \n 9 AGRN                    18.5                     21.5            4.78       25.3            25.8          22.7     20.0          18.8  \n10 C1orf159                 9.30                     6.11           5.08        7.60            8.15          7.57    10.3           5.51 \n# \u2139 14,230 more rows\n# \u2139 46 more variables: Brain_Anterior_cingulate_cortex_BA24 <dbl>, Brain_Caudate_basal_ganglia <dbl>, Brain_Cerebellar_Hemisphere <dbl>,\n#   Brain_Cerebellum <dbl>, Brain_Cortex <dbl>, Brain_Frontal_Cortex_BA9 <dbl>, Brain_Hippocampus <dbl>, Brain_Hypothalamus <dbl>,\n#   Brain_Nucleus_accumbens_basal_ganglia <dbl>, Brain_Putamen_basal_ganglia <dbl>, Brain_Spinal_cord_cervical_c1 <dbl>,\n#   Brain_Substantia_nigra <dbl>, Breast_Mammary_Tissue <dbl>, Cells_Cultured_fibroblasts <dbl>, Cells_EBV_transformed_lymphocytes <dbl>,\n#   Cervix_Ectocervix <dbl>, Cervix_Endocervix <dbl>, Colon_Sigmoid <dbl>, Colon_Transverse <dbl>, Esophagus_Gastroesophageal_Junction <dbl>,\n#   Esophagus_Mucosa <dbl>, Esophagus_Muscularis <dbl>, Fallopian_Tube <dbl>, Heart_Atrial_Appendage <dbl>, Heart_Left_Ventricle <dbl>, \u2026\n# \u2139 Use `print(n = ...)` to see more rows\n")),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"You've explored tibbles before.  How many rows and columns does the data have?"))),(0,i.kt)("p",null,"The data is essentially a big table of expression values.  To work with it more easily, let's convert to a matrix:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"gene_names = gtex$gene_name\ngtex = as.matrix( gtex[,2:ncol(gtex)] )\nrow.names( gtex ) = gene_names\n")),(0,i.kt)("p",null,"And print it again:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"gtex[1:10,1:10]\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"          Adipose_Subcutaneous Adipose_Visceral_Omentum Adrenal_Gland Artery_Aorta Artery_Coronary Artery_Tibial  Bladder Brain_Amygdala\nLINC01128             7.441180                 7.797220       4.03224     8.845420        8.720360     11.097400  7.62418       2.977490\nLINC00115             4.490250                 3.424820       2.75144     6.225130        5.935010      7.817070  7.57255       1.453660\nSAMD11                0.476230                 2.931190       3.78499     5.717060        3.104580      7.931910 19.05830       0.532897\nNOC2L                52.861400                48.187700      37.17370    55.491600       51.901500     62.564000 71.86850      18.344900\nKLHL17                9.678200                 8.967750       7.89155    13.917400       13.392400     10.740400 17.60890       3.048490\nPLEKHN1               0.559729                 0.648233       1.92579     0.744398        0.868276      0.717782  4.22114       0.107346\nHES4                 21.789300                24.187600       2.91384    46.628900       64.610400     98.388500 33.05170      16.737000\nISG15                36.599900                35.009300      13.45140    50.760100       43.741600     50.375500 32.98460      43.609600\nAGRN                 18.538800                21.475700       4.78231    25.299100       25.774100     22.740600 20.00260      18.847400\nC1orf159              9.295820                 6.112750       5.07871     7.598480        8.150340      7.573130 10.28930       5.512330\n          Brain_Anterior_cingulate_cortex_BA24 Brain_Caudate_basal_ganglia\nLINC01128                             4.992650                    3.862590\nLINC00115                             1.423120                    2.043400\nSAMD11                                0.466223                    2.217410\nNOC2L                                27.560400                   25.096000\nKLHL17                                5.058480                    4.410430\nPLEKHN1                               0.100712                    0.121139\nHES4                                 20.636600                   31.458800\nISG15                                25.535200                   27.367600\nAGRN                                 22.643900                   19.735000\nC1orf159                              6.878150                    6.623100\n")),(0,i.kt)("h2",{id:"checking-the-gene-annotations"},"Checking the gene annotations"),(0,i.kt)("p",null,"Let's also look at the first rows in the gene annotations table. You'll notice that this table contains information pertaining each gene, such as its name, unique ID, genomic location (chromosome, start position, and end position), and its gene family."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"print(gene_annotations)\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-r"},"# A tibble: 14,240 \xd7 7\n   gene_name gene_id         gene_symbol chr     start     end biotype       \n   <chr>     <chr>           <chr>       <chr>   <dbl>   <dbl> <chr>         \n 1 LINC01128 ENSG00000228794 LINC01128   1      825138  859446 lncRNA        \n 2 LINC00115 ENSG00000225880 LINC00115   1      826206  827522 lncRNA        \n 3 SAMD11    ENSG00000187634 SAMD11      1      923923  944575 protein_coding\n 4 NOC2L     ENSG00000188976 NOC2L       1      944203  959309 protein_coding\n 5 KLHL17    ENSG00000187961 KLHL17      1      960584  965719 protein_coding\n 6 PLEKHN1   ENSG00000187583 PLEKHN1     1      966482  975865 protein_coding\n 7 HES4      ENSG00000188290 HES4        1      998962 1000172 protein_coding\n 8 ISG15     ENSG00000187608 ISG15       1     1001138 1014540 protein_coding\n 9 AGRN      ENSG00000188157 AGRN        1     1020120 1056118 protein_coding\n10 C1orf159  ENSG00000131591 C1orf159    1     1081818 1116361 protein_coding\n# \u2139 14,230 more rows\n# \u2139 Use `print(n = ...)` to see more rows\n")),(0,i.kt)("p",null,"You are now ready to ",(0,i.kt)("a",{parentName:"p",href:"/whg-training-resources/data_visualisation/visualising_rna-seq_data/visualising"},"start exploring this data set"),"."))}u.isMDXComponent=!0}}]);