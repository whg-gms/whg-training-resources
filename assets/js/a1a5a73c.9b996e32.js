"use strict";(self.webpackChunkwhg_training_resources=self.webpackChunkwhg_training_resources||[]).push([[1329],{3905:(a,e,t)=>{t.d(e,{Zo:()=>N,kt:()=>h});var s=t(7294);function n(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function m(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,s)}return t}function p(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){n(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function r(a,e){if(null==a)return{};var t,s,n=function(a,e){if(null==a)return{};var t,s,n={},m=Object.keys(a);for(s=0;s<m.length;s++)t=m[s],e.indexOf(t)>=0||(n[t]=a[t]);return n}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(s=0;s<m.length;s++)t=m[s],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(n[t]=a[t])}return n}var l=s.createContext({}),i=function(a){var e=s.useContext(l),t=e;return a&&(t="function"==typeof a?a(e):p(p({},e),a)),t},N=function(a){var e=i(a.components);return s.createElement(l.Provider,{value:e},a.children)},o="mdxType",c={inlineCode:"code",wrapper:function(a){var e=a.children;return s.createElement(s.Fragment,{},e)}},k=s.forwardRef((function(a,e){var t=a.components,n=a.mdxType,m=a.originalType,l=a.parentName,N=r(a,["components","mdxType","originalType","parentName"]),o=i(t),k=n,h=o["".concat(l,".").concat(k)]||o[k]||c[k]||m;return t?s.createElement(h,p(p({ref:e},N),{},{components:t})):s.createElement(h,p({ref:e},N))}));function h(a,e){var t=arguments,n=e&&e.mdxType;if("string"==typeof a||n){var m=t.length,p=new Array(m);p[0]=k;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=a,r[o]="string"==typeof a?a:n,p[1]=r;for(var i=2;i<m;i++)p[i]=t[i];return s.createElement.apply(null,p)}return s.createElement.apply(null,t)}k.displayName="MDXCreateElement"},8391:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>p,default:()=>c,frontMatter:()=>m,metadata:()=>r,toc:()=>i});var s=t(7462),n=(t(7294),t(3905));const m={sidebar_position:2},p="Principal components analysis",r={unversionedId:"population_genetics/principal_components_analysis/README",id:"population_genetics/principal_components_analysis/README",title:"Principal components analysis",description:"Welcome!  In this practical we will do principal component analysis (PCA), one of the fundamental tools of population",source:"@site/docs/population_genetics/principal_components_analysis/README.md",sourceDirName:"population_genetics/principal_components_analysis",slug:"/population_genetics/principal_components_analysis/",permalink:"/whg-training-resources/population_genetics/principal_components_analysis/",draft:!1,editUrl:"https://github.com/whg-training/whg-training-resources/edit/main/docs/population_genetics/principal_components_analysis/README.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"sidebar7",previous:{title:"Some population-genetic statistics",permalink:"/whg-training-resources/population_genetics/simulation/statistics"},next:{title:"A warm-up example",permalink:"/whg-training-resources/population_genetics/principal_components_analysis/simulated_pca_example"}},l={},i=[{value:"How PCA works",id:"how-pca-works",level:2},{value:"Principal components for GWAS",id:"principal-components-for-gwas",level:2}],N={toc:i},o="wrapper";function c(a){let{components:e,...t}=a;return(0,n.kt)(o,(0,s.Z)({},N,t,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"principal-components-analysis"},"Principal components analysis"),(0,n.kt)("p",null,"Welcome!  In this practical we will do principal component analysis (PCA), one of the fundamental tools of population\ngenetics for identifying sample clustering and outliers. PCA is several things at the same time: a way of ",(0,n.kt)("strong",{parentName:"p"},"reducing the\ndimension")," of a giant matrix of genotypes by projecting it onto a smaller set of important directions; a way to\nevaluate and intepret ",(0,n.kt)("em",{parentName:"p"},"relatedness")," and ",(0,n.kt)("em",{parentName:"p"},"population structure")," between samples; a way to find ",(0,n.kt)("strong",{parentName:"p"},"data outliers")," and\nunexpected samples.  "),(0,n.kt)("p",null,"Because these features are often correlated to environmental factors in a large dataset,  this makes it a great way to\npotentially control for environmental confounding in genome-wide association studies."),(0,n.kt)("h2",{id:"how-pca-works"},"How PCA works"),(0,n.kt)("p",null,"Imagine we a giant matrix of numbers - say one with ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"L")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"L")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"L")))))," rows and ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"N")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," columns, like this:"),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mtable",{parentName:"mrow",rowspacing:"0.16em",columnalign:"center center center center center",columnlines:"solid none none none",columnspacing:"1em",rowlines:"solid none none none"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mtext",{parentName:"mstyle"},"column\xa01"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mtext",{parentName:"mstyle"},"column\xa02"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mo",{parentName:"mstyle",lspace:"0em",rspace:"0em"},"\u22ef"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mtext",{parentName:"mrow"},"column\xa0"),(0,n.kt)("mstyle",{parentName:"mrow",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mi",{parentName:"mstyle"},"N")))))),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mtext",{parentName:"mrow"},"row\xa0"),(0,n.kt)("mstyle",{parentName:"mrow",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mn",{parentName:"mstyle"},"1"))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mn",{parentName:"msub"},"11")))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mn",{parentName:"msub"},"12")))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mo",{parentName:"mstyle",lspace:"0em",rspace:"0em"},"\u22ef"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mi",{parentName:"mrow"},"N")))))),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mtext",{parentName:"mrow"},"row\xa0"),(0,n.kt)("mstyle",{parentName:"mrow",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mn",{parentName:"mstyle"},"2"))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mn",{parentName:"msub"},"21")))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mn",{parentName:"msub"},"22")))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mo",{parentName:"mstyle",lspace:"0em",rspace:"0em"},"\u22ef"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mn",{parentName:"mrow"},"2"),(0,n.kt)("mi",{parentName:"mrow"},"N")))))),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mi",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"mi",mathvariant:"normal"},"\u22ee"),(0,n.kt)("mpadded",{parentName:"mi",height:"0em",voffset:"0em"},(0,n.kt)("mspace",{parentName:"mpadded",mathbackground:"black",width:"0em",height:"1.5em"}))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mi",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"mi",mathvariant:"normal"},"\u22ee"),(0,n.kt)("mpadded",{parentName:"mi",height:"0em",voffset:"0em"},(0,n.kt)("mspace",{parentName:"mpadded",mathbackground:"black",width:"0em",height:"1.5em"}))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mo",{parentName:"mstyle",lspace:"0em",rspace:"0em"},"\u22f1"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"})))),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mtext",{parentName:"mrow"},"row\xa0"),(0,n.kt)("mstyle",{parentName:"mrow",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mi",{parentName:"mstyle"},"L"))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mi",{parentName:"mrow"},"L"),(0,n.kt)("mn",{parentName:"mrow"},"1"))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mi",{parentName:"mrow"},"L"),(0,n.kt)("mn",{parentName:"mrow"},"2"))))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("mo",{parentName:"mstyle",lspace:"0em",rspace:"0em"},"\u22ef"))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"false"},(0,n.kt)("msub",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"msub"},"x"),(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mi",{parentName:"mrow"},"L"),(0,n.kt)("mi",{parentName:"mrow"},"N")))))))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X = \\begin{array}{c|cccc} & \\text{column 1} & \\text{column 2} & \\cdots & \\text{column $N$} \\\\ \\hline \\text{row $1$} & x_{11} & x_{12} & \\cdots & x_{1N} \\\\ \\text{row $2$} & x_{21} & x_{22} & \\cdots & x_{2N} \\\\ \\vdots & \\vdots & & \\ddots & \\\\ \\text{row $L$} & x_{L1} & x_{L2} & \\cdots & x_{LN} \\end{array}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"6.66em",verticalAlign:"-3.08em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.58em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"5.58em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-6.4275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-5.2275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"row\xa01")))),(0,n.kt)("span",{parentName:"span",style:{top:"-4.0275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"row\xa02")))),(0,n.kt)("span",{parentName:"span",style:{top:"-2.1675em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"\u22ee"),(0,n.kt)("span",{parentName:"span",className:"mord rule",style:{borderRightWidth:"0em",borderTopWidth:"1.5em",bottom:"0em"}})))),(0,n.kt)("span",{parentName:"span",style:{top:"-0.9675em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"row\xa0"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"L"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"vertical-separator",style:{height:"6.66em",borderRightWidth:"0.04em",borderRightStyle:"solid",margin:"0 -0.02em",verticalAlign:"-3.08em"}}),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-6.4275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"column\xa01")))),(0,n.kt)("span",{parentName:"span",style:{top:"-5.2275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"11"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-4.0275em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"21"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-2.1675em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"\u22ee"),(0,n.kt)("span",{parentName:"span",className:"mord rule",style:{borderRightWidth:"0em",borderTopWidth:"1.5em",bottom:"0em"}})))),(0,n.kt)("span",{parentName:"span",style:{top:"-0.9675em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.6875em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"L"),(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-6.24em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"column\xa02")))),(0,n.kt)("span",{parentName:"span",style:{top:"-5.04em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"12"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.84em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"22"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-1.98em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-0.78em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"L"),(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-6.24em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"minner"},"\u22ef"))),(0,n.kt)("span",{parentName:"span",style:{top:"-5.04em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"minner"},"\u22ef"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.84em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"minner"},"\u22ef"))),(0,n.kt)("span",{parentName:"span",style:{top:"-1.98em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"minner"},"\u22f1"))),(0,n.kt)("span",{parentName:"span",style:{top:"-0.78em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"minner"},"\u22ef")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}),(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.58em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-6.24em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"column\xa0"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))),(0,n.kt)("span",{parentName:"span",style:{top:"-5.04em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"1"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.84em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-1.98em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-0.78em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"L"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"arraycolsep",style:{width:"0.5em"}}))),(0,n.kt)("span",{parentName:"span",style:{top:"-7.96em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"5.58em"}}),(0,n.kt)("span",{parentName:"span",className:"hline",style:{borderBottomWidth:"0.04em"}}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.08em"}},(0,n.kt)("span",{parentName:"span"})))))))))),(0,n.kt)("p",null,"For example - it could be a matrix of genotypes in a genome-wide association study (rows are SNPs and columns are samples).  Or it could ba a matrix of expression levels (rows are genes and columns are samples).  Whatever it is, it it's a big multidimensional object, and it would be nice to have a simple way to visualise and analyse its structure."),(0,n.kt)("p",null,"Principal components analysis (PCA) does this by re-writing the matrix in terms of a small number of 'principal components' - directions in space. The directions are ",(0,n.kt)("em",{parentName:"p"},"orthogonal")," to each other (i.e. at right angles) so, in a sense, they each represent a seperate part of the matrix.\nTogether, the principal components capture the major structure of the matrix and often reveal the most important features."),(0,n.kt)("h2",{id:"principal-components-for-gwas"},"Principal components for GWAS"),(0,n.kt)("p",null,"In this tutorial you will carry out principal components analysis on a set of human samples using the plink software\npackage.  Because this is for use in a ",(0,n.kt)("a",{parentName:"p",href:"/whg-training-resources/genome_wide_association_studies/genome_wide_association_analysis/"},"GWAS\nstudy"),", we will carry out many of the\nsteps that are usually done in those studies, including  including ",(0,n.kt)("em",{parentName:"p"},"pruning SNPs for local correlation patterns"),",\n",(0,n.kt)("em",{parentName:"p"},"identifying and excluding closely-related individuals"),", and ",(0,n.kt)("em",{parentName:"p"},"comparing samples to a global reference panel"),".   Before\ndoing that, however, we'll also try a simple simulated PCA example in R."),(0,n.kt)("p",null,"When you're ready, go and ",(0,n.kt)("a",{parentName:"p",href:"/whg-training-resources/population_genetics/principal_components_analysis/getting_setup"},"get setup")," for the practical.  The complete set of pages is as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/"},"Introduction")," (this page)"),(0,n.kt)("li",{parentName:"ul"},"Try a ",(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/simulated_pca_example"},"PCA warm-up in R")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/getting_setup"},"Getting the software and data")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/overview"},"Practical overview")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/ld_pruning"},"Linkage disequilibrium pruning")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/relatedness_pruning"},"Relatedness pruning")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/computing_PCs"},"Computing PCs")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/the_maths"},"An aside on the maths")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/whg-training-resources/population_genetics/principal_components_analysis/global_analysis"},"Analysing samples against a global panel"))))}c.isMDXComponent=!0}}]);